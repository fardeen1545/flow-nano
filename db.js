const e="imageStore";let r=null;function t(){return r||(r=new Promise((r,t)=>{const o=indexedDB.open("AutoFlowDB",1);o.onupgradeneeded=r=>{const t=r.target.result;t.objectStoreNames.contains(e)||t.createObjectStore(e,{keyPath:"id"})},o.onsuccess=e=>{r(e.target.result)},o.onerror=e=>{console.error("IndexedDB open error:",e.target.error),t(e.target.error)}}),r)}export async function saveImage(r){const o=await t(),n=crypto.randomUUID(),a={id:n,name:r.name,type:r.type},s={id:n,file:r};return new Promise((r,t)=>{const n=o.transaction(e,"readwrite").objectStore(e).put(s);n.onsuccess=()=>{r(a)},n.onerror=e=>{console.error("IndexedDB put error:",e.target.error),t(e.target.error)}})}export async function getImage(r){const o=await t();return new Promise((t,n)=>{const a=o.transaction(e,"readonly").objectStore(e).get(r);a.onsuccess=e=>{e.target.result?t(e.target.result.file):t(null)},a.onerror=e=>{console.error("IndexedDB get error:",e.target.error),n(e.target.error)}})}export async function deleteImage(r){const o=await t();return new Promise((t,n)=>{const a=o.transaction(e,"readwrite").objectStore(e).delete(r);a.onsuccess=()=>{t()},a.onerror=e=>{console.error("IndexedDB delete file error:",e.target.error),n(e.target.error)}})}export async function clearAllImages(){const r=await t();return new Promise((t,o)=>{const n=r.transaction(e,"readwrite").objectStore(e).clear();n.onsuccess=()=>{t()},n.onerror=e=>{console.error("IndexedDB clear error:",e.target.error),o(e.target.error)}})}