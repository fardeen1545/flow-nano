import{dom as t}from"./dom.js";import{state as e}from"./state.js";import{updateMainButton as n,updateFailedPromptsUI as a,updateUIAfterModeChange as o,updateLiveStatus as l,renderToolsList as s}from"./ui.js";import{i18n as r,translations as i}from"./i18n.js";export function setLanguage(t){e.currentLang=i[t]?t:"en",chrome.storage.local.set({language:e.currentLang}),document.querySelectorAll("[data-lang-key]").forEach(t=>{const n=t.getAttribute("data-lang-key");if(i[e.currentLang]?.[n])if("wrong-page-message"===t.id)t.innerHTML=r(n);else{let e=t;if("BUTTON"===t.tagName&&t.querySelector(".material-symbols-outlined")){const n=t.querySelectorAll("span:not(.material-symbols-outlined)");n.length>0&&(e=n[n.length-1])}else t.classList.contains("tab-button")&&t.querySelector("span")?e=t.querySelector("span:last-of-type"):(t.matches("a.sample-link")||t.matches("a#openDownloadsSettingsLink")||"LABEL"===t.tagName||t.classList.contains("section-title")||t.classList.contains("donate-text")||"OPTION"===t.tagName||t.classList.contains("mode-toggle-button"))&&(e=t);if(e&&e.textContent!==r(n))if(e.classList.contains("mode-toggle-button")){const t=e.querySelector(".material-symbols-outlined");e.textContent=r(n),e.prepend(t)}else e.textContent=r(n)}}),document.querySelectorAll("[data-lang-placeholder]").forEach(t=>{const n=t.getAttribute("data-lang-placeholder");i[e.currentLang]?.[n]&&(t.placeholder=r(n))}),document.querySelectorAll("[data-lang-title]").forEach(t=>{const n=t.getAttribute("data-lang-title");i[e.currentLang]?.[n]&&(t.title=r(n))});const c=document.getElementById("userGuideNote"),u=document.getElementById("userGuideLink");c&&(c.textContent=r("user_guide_note")),u&&(u.textContent=r("user_guide_link_text"),"vi"===e.currentLang?u.href="https://github.com/duckmartians/Auto-Flow/blob/main/README_vi.md":u.href="https://github.com/duckmartians/Auto-Flow/blob/main/README.md"),n(),a(),o(),e.isRunning||e.downloadInterval||e.finalScanTimerId||l(r("status_ready")),s()}